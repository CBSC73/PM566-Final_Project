---
title: "PM566 Final Project"
author: "CB"
date: "`r Sys.Date()`"
output: github_document
always_allow_html: true
---

```{r setup, include=FALSE} 
knitr::opts_chunk$set(echo = TRUE)
options(repos = c(CRAN = "http://cran.rstudio.com"))
```

```{r, Load required libraries, include=FALSE}
library(data.table)
library(dplyr)
library(tidyverse)
library(leaflet)
library(dtplyr)
library(knitr)
library(ggplot2)
library(readr)
library(plotly)
```

```{r, upload dataset, include=FALSE}
if (!file.exists("https://raw.githubusercontent.com/CBSC73/PM566-Final_Project/main/Vaccination_Coverage_dataset.txt")) {
  download.file("https://raw.githubusercontent.com/CBSC73/PM566-Final_Project/main/Vaccination_Coverage_dataset.txt", 
                "Vaccination_Coverage_dataset.txt", method="libcurl", timeout = 60)  
}

vax <- data.table::fread("Vaccination_Coverage_dataset.txt", stringsAsFactors = F, data.table=getOption("datatable.fread.datatable", TRUE), drop=8:9)  
```


```{r, look at variables, include=FALSE}
dim(vax)
head(vax)
```


```{r, clean data, include=FALSE}

#Rename columns
vax <- rename(vax, Year="Survey Year/Influenza Season", Percent_Vax="Estimate (%)",Age_Ethn="Dimension Type", Geog_Type="Geography Type")


#Select Influenza data only, remove District of Columbia and City of New York/Rest of state (50 states only)
vaxdf<- as.data.frame(vax)
vaxtrim <-vaxdf %>% filter(Vaccine=="Influenza", Geography!="District of Columbia", Geography!="NY-City of New York", Geography!="NY-Rest of state", Geography!="Puerto Rico", Geography!="United States")



unique(vaxtrim$Geography)
#There are only 46 states available in the dataset. Missing states are: Arizona, California, Idaho, South Carolina.
```



